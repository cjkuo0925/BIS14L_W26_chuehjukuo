---
title: "Homework 13"
author: "Chueh-Ju Kuo"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: spacelab
  pdf_document: default
---

## Instructions
Answer the following questions and complete the exercises in RMarkdown. Please embed all of your code and push your final work to your repository. Your final lab report should be organized, clean, and run free from errors. Remember, you must remove the `#` for the included code chunks to run. Be sure to add your name to the author header above.  

Make sure to use the formatting conventions of RMarkdown to make your report neat and clean!  

## Load the libraries
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(janitor)
library(naniar)
``` 

## Data
For this homework, we will use `amniota` data from: Myhrvold N, Baldridge E, Chan B, Sivam D, Freeman DL, Ernest SKM (2015). “An amniote life-history database to perform comparative analyses with birds, mammals, and reptiles.” _Ecology_, *96*, 3109. doi: 10.1890/15-0846.1 (URL: https://doi.org/10.1890/15-0846.1).
```{r message=FALSE, warning=FALSE}
amniota <- read_csv("data/amniota.csv") %>% 
  clean_names()
```

1. Do some exploratory analysis of the `amniota` data set. Use the function(s) of your choice. Try to get an idea of how NA's are represented in the data.
```{r message=FALSE, warning=FALSE}
glimpse(amniota)
```

```{r message=FALSE, warning=FALSE}
summary(amniota)
```
2. Make any necessary replacements in the data such that all NA's appear as "NA". 
```{r}
amniota_no_na<-amniota %>% 
  replace_with_na_all(condition=~.x %in% c(-999, -999.00, -999.00000, -999.000))
```

3. How many total NA's are in the data set? Use the package `naniar` to produce a summary, including percentages, of missing data in each column for the `amniota` data.
```{r}
amniota_no_na%>%
  miss_var_summary()%>%
  summarize(total_na=sum(n_miss))
```

```{r}
miss_var_summary(amniota_no_na)
```


4. Double check your replacement using `summary`. Do you see any other potential issues? If so, fix them.
- Subspecies doesnot have any value it is all NA(but cannot be fix since this is also true for the original data)
- birth_or_hatching_weight_g, adult_body_mass_g and no_sex_body_mass_g have a minimun of zero, might also indicate presence of NA.
- female_maturity_d have a very negative minimum, but not sure what does it means so I will keep it for now.
```{r}
summary(amniota_no_na)
```

```{r}
amniota_no_na <- amniota_no_na %>%
  mutate(across(c(birth_or_hatching_weight_g, 
                  adult_body_mass_g,
                  no_sex_body_mass_g),
                ~na_if(., 0)))
```

5. Use `naniar` to visualize the number of NA's in each variable. Which variables have the most NA's?
subspecies and female_body_mass_at_maturity_g have the most NA
```{r}
amniota_no_na%>%
  gg_miss_var()
```

6. Calculate the number of NAs in the `egg_mass_g` column sorted by taxonomic class; i.e. how many NA's are present in the `egg_mass_g` column in birds, mammals, and reptiles? Does this results make sense biologically? How do these results affect your interpretation of NA's?
Reptiles have the most numbers of NA. This make sense reptile eggs are often more difficult to observe and measure compared to those of birds and mammals. Data collection for reptiles is more challenging while many reptile species lays eggs in concealed environment. The flexible and soft shells of their eggs also make it harder to obtain accurate measurements of the eggs.

The numbers of NA leaves room for further interpretation of the data. While many data is lacking, analyses based on current database is limited and may be biased or incomplete. Further data collection and investigation would be necessary to improve the reliability of conclusions drawn from this dataset.
```{r}
amniota_no_na%>%
  select(egg_mass_g, class)%>%
  group_by(class)%>%
  miss_var_summary()
```

## Knit and Upload
Please knit your work as an .html file and upload to Canvas. Homework is due before the start of the next lab. No late work is accepted. Make sure to use the formatting conventions of RMarkdown to make your report neat and clean! 